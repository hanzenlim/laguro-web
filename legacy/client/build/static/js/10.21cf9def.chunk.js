webpackJsonp([10],{1205:function(e,t,n){"use strict";var r=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(1)),i=r(n(1206)),u=(0,i.default)(a.default.createElement("g",null,a.default.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})),"Delete");t.default=u},1206:function(e,t,n){"use strict";function r(e,t){var n=function(t){return i.default.createElement(c.default,t,e)};return n.displayName=t,n=(0,u.default)(n),n.muiName="SvgIcon",n}var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(1)),u=a(n(27)),c=a(n(21)),o=r;t.default=o},1207:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u});var r="\n    query ($input: QueryParams!) {\n        queryPatientDocument(input: $input){\n            id,\n            healthInsuranceImages\n        }\n    }\n",a="\n    mutation UpdatePatientDocument($input: UpdatePatientDocumentInput!) {\n        updatePatientDocument(input: $input) {\n            healthInsuranceImages \n        }\n    }\n",i="\n    mutation CreatePatientDocument($input: CreatePatientDocumentInput!) {\n        createPatientDocument(input: $input) {\n            id\n        }\n    }\n",u="\n    query ($type: String!, $handle: String) {\n        getFileStackPolicySignature(type: $type, handle: $handle) {\n            signature,\n            policy,\n        }\n    }\n"},986:function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(a,i){try{var u=t[a](i),c=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});e(c)}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"NoReduxUploadHealthInsurance",function(){return A});var s=n(14),l=n.n(s),p=n(1),f=n.n(p),d=n(19),h=n(324),g=n.n(h),m=n(15),y=n(1205),v=n.n(y),b=n(20),x=n(1207),k=n(25),S=n(323),P=(n.n(S),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()),w=o(["\n    position: absolute;\n    top: 0;\n    left: 604px;\n"],["\n    position: absolute;\n    top: 0;\n    left: 604px;\n"]),I=o(["\n    position: relative;\n"],["\n    position: relative;\n"]),U=o(["\n    width: 600px;\n    margin: 0 8px 8px 0;\n    object-fit: contain;\n"],["\n    width: 600px;\n    margin: 0 8px 8px 0;\n    object-fit: contain;\n"]),j=m.b.div(w),O=m.b.div(I),E=m.b.img(U),A=function(e){function t(e){var n=this;i(this,t);var c=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return c.extractUrlToState=function(){var e=a(l.a.mark(function e(t){var a,i,u,o,s,p,f,d,h,g;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.filesUploaded,i=[].concat(r(c.state.signedUrlArr)),u=[].concat(r(c.state.urlArr)),o=!0,s=!1,p=void 0,e.prev=6,f=a[Symbol.iterator]();case 8:if(o=(d=f.next()).done){e.next=18;break}return h=d.value,e.next=12,c.generateImageSignature(h.url);case 12:g=e.sent,i.push(g),u.push(h.url);case 15:o=!0,e.next=8;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(6),s=!0,p=e.t0;case 24:e.prev=24,e.prev=25,!o&&f.return&&f.return();case 27:if(e.prev=27,!s){e.next=30;break}throw p;case 30:return e.finish(27);case 31:return e.finish(24);case 32:c.setState({signedUrlArr:i,urlArr:u});case 33:case"end":return e.stop()}},e,n,[[6,20,24,32],[25,,27,31]])}));return function(t){return e.apply(this,arguments)}}(),c.deleteImage=function(e){var t=e.currentTarget.dataset.imageindex,n=[].concat(r(c.state.signedUrlArr)),a=[].concat(r(c.state.urlArr));n.splice(t,1),a.splice(t,1),c.setState({signedUrlArr:n,urlArr:a})},c.handleSubmit=a(l.a.mark(function e(){var t,r,a,i,u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.props.auth,e.next=3,Object(k.a)(x.c,{input:{partitionKey:"patientId",partitionValue:t&&t.id}});case 3:if(r=e.sent,a=r&&r.data&&r.data.queryPatientDocument[0]&&r.data.queryPatientDocument[0].id,i=void 0,a){e.next=12;break}return e.next=9,Object(k.a)(x.a,{input:{patientId:t&&t.id,healthInsuranceImages:c.state.signedUrlArr}});case 9:i=e.sent,e.next=16;break;case 12:return u={id:a,healthInsuranceImages:c.state.signedUrlArr},e.next=15,Object(k.a)(x.d,{input:u});case 15:i=e.sent;case 16:i&&!i.errors?alert("Successfully saved images"):alert("Something went wrong. Please try again later");case 17:case"end":return e.stop()}},e,n)})),c.state={uploadPolicySignature:"",isLoading:!0,signedUrlArr:[],urlArr:[]},c}return c(t,e),P(t,[{key:"componentDidMount",value:function(){function e(){return t.apply(this,arguments)}var t=a(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.auth){e.next=8;break}return e.next=3,this.getPatientDocuments(this.props.auth.id);case 3:return t=e.sent,e.next=6,this.getUploadPolicySignature();case 6:n=e.sent,this.setState(Object.assign({isLoading:!1},t,n));case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"componentDidUpdate",value:function(){function e(){return t.apply(this,arguments)}var t=a(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.auth||!this.state.isLoading){e.next=8;break}return e.next=3,this.getPatientDocuments(this.props.auth.id);case 3:return t=e.sent,e.next=6,this.getUploadPolicySignature();case 6:n=e.sent,this.setState(Object.assign({isLoading:!1},t,n));case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"getUploadPolicySignature",value:function(){function e(){return t.apply(this,arguments)}var t=a(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(x.b,{type:"upload"});case 2:return t=e.sent,n=t&&t.data&&t.data.getFileStackPolicySignature,e.abrupt("return",{uploadPolicySignature:n});case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"getViewPolicySignature",value:function(){function e(e){return t.apply(this,arguments)}var t=a(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(x.b,{type:"view",handle:t});case 2:return n=e.sent,e.abrupt("return",n&&n.data);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"getPatientDocuments",value:function(){function e(e){return t.apply(this,arguments)}var t=a(l.a.mark(function e(t){var n,r,a,i,u,c,o,s,p,f;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(x.c,{input:{partitionKey:"patientId",partitionValue:t}});case 2:if(n=e.sent,n=n&&n.data&&n.data.queryPatientDocument[0],r=[],a=[],!(n&&n.healthInsuranceImages&&n.healthInsuranceImages.length>0)){e.next=37;break}i=!0,u=!1,c=void 0,e.prev=10,o=n.healthInsuranceImages[Symbol.iterator]();case 12:if(i=(s=o.next()).done){e.next=22;break}return p=s.value,e.next=16,this.generateImageSignature(p);case 16:f=e.sent,r.push(f),a.push(p);case 19:i=!0,e.next=12;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(10),u=!0,c=e.t0;case 28:e.prev=28,e.prev=29,!i&&o.return&&o.return();case 31:if(e.prev=31,!u){e.next=34;break}throw c;case 34:return e.finish(31);case 35:return e.finish(28);case 36:return e.abrupt("return",{signedUrlArr:r,urlArr:a});case 37:return e.abrupt("return",null);case 38:case"end":return e.stop()}},e,this,[[10,24,28,36],[29,,31,35]])}));return e}()},{key:"generateImageSignature",value:function(){function e(e){return t.apply(this,arguments)}var t=a(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getViewPolicySignature(t.split("/")[3]);case 2:return n=e.sent,e.abrupt("return",t+"?policy="+n.getFileStackPolicySignature.policy+"&signature="+n.getFileStackPolicySignature.signature);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"renderUploadedImages",value:function(){var e=this;return this.state.signedUrlArr.length<=0?"":this.state.signedUrlArr.map(function(t,n){return f.a.createElement(O,{key:n},f.a.createElement(E,{"data-name":"styledUploadedImage",src:t,key:"img-"+n,alt:"uploadedImage"}),f.a.createElement(j,{"data-imageindex":n,onClick:e.deleteImage},f.a.createElement(v.a,{style:{fontSize:"40px"}})))})}},{key:"render",value:function(){return f.a.createElement(b.f,null,f.a.createElement(b.a,{pt:50},f.a.createElement("div",null,f.a.createElement(b.q,{fontSize:5,fontWeight:"regular",color:"black"},"Health insurance card")),f.a.createElement("div",null,f.a.createElement(b.q,{fontSize:3},"Please upload a picture of your health insurance card front and back.")),f.a.createElement(b.a,{pt:10},this.renderUploadedImages()),!this.state.isLoading&&f.a.createElement(g.a,{apikey:S.secureFilestackKey,security:{policy:this.state.uploadPolicySignature.policy,signature:this.state.uploadPolicySignature.signature},options:{accept:["image/*"],imageMin:[300,300],maxFiles:5,fromSources:["local_file_system","url","imagesearch","facebook","instagram"],storeTo:{location:"s3"}},onSuccess:this.extractUrlToState,render:function(e){var t=e.onPick;return f.a.createElement(b.b,{onClick:t,color:"primary"},"Upload Images")}}),f.a.createElement(b.a,{pt:10},f.a.createElement(b.b,{onClick:this.handleSubmit,color:"secondary",type:"submit"},"Save"))))}}]),t}(p.Component),D=function(e){return{auth:e.auth}};t.default=Object(d.b)(D,null)(A)}});
//# sourceMappingURL=10.21cf9def.chunk.js.map